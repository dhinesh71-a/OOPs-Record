import javafx.application.Application;
import javafx.stage.Stage;
import javafx.stage.FileChooser;
import javafx.scene.Scene;
import javafx.scene.layout.VBox;
import javafx.scene.layout.HBox;
import javafx.scene.control.Button;
import javafx.scene.control.Label;
import javafx.scene.media.Media;
import javafx.scene.media.MediaPlayer;
import javafx.geometry.Pos;
import javafx.util.Duration;
import java.io.File;

public class MediaPlayerApp extends Application {

    private MediaPlayer mediaPlayer;
    private Label statusLabel;

    @Override
    public void start(Stage stage) {

        stage.setTitle("JavaFX Media Player - DHINESH KUMAR G (2117240070071)");

        statusLabel = new Label("No file loaded");
        statusLabel.setStyle("-fx-font-size: 14; -fx-text-fill: blue;");

        // Buttons
        Button loadButton = new Button("Load File");
        Button playButton = new Button("Play");
        Button pauseButton = new Button("Pause");
        Button stopButton = new Button("Stop");

        // Styles
        loadButton.setStyle("-fx-background-color: #2196F3; -fx-text-fill: white; -fx-font-weight: bold;");
        playButton.setStyle("-fx-background-color: #4CAF50; -fx-text-fill: white; -fx-font-weight: bold;");
        pauseButton.setStyle("-fx-background-color: #FFC107; -fx-text-fill: black; -fx-font-weight: bold;");
        stopButton.setStyle("-fx-background-color: #f44336; -fx-text-fill: white; -fx-font-weight: bold;");

        // Events
        loadButton.setOnAction(e -> loadMedia(stage));
        playButton.setOnAction(e -> playMedia());
        pauseButton.setOnAction(e -> pauseMedia());
        stopButton.setOnAction(e -> stopMedia());

        HBox controls = new HBox(15, loadButton, playButton, pauseButton, stopButton);
        controls.setAlignment(Pos.CENTER);

        Label footer = new Label("Developed by DHINESH KUMAR G - Reg No: 2117240070071");
        footer.setStyle("-fx-text-fill: darkblue; -fx-font-weight: bold; -fx-font-size: 13;");

        VBox root = new VBox(20, statusLabel, controls, footer);
        root.setAlignment(Pos.CENTER);
        root.setStyle("-fx-padding: 25; -fx-background-color: white;");

        Scene scene = new Scene(root, 500, 300);
        stage.setScene(scene);
        stage.show();
    }

    private void loadMedia(Stage stage) {
        FileChooser fileChooser = new FileChooser();
        fileChooser.setTitle("Select a Media File");
        fileChooser.getExtensionFilters().add(
                new FileChooser.ExtensionFilter("Media Files", "*.mp3", "*.mp4", "*.wav")
        );

        File selectedFile = fileChooser.showOpenDialog(stage);

        if (selectedFile != null) {
            try {
                if (mediaPlayer != null) mediaPlayer.stop();

                Media media = new Media(selectedFile.toURI().toString());
                mediaPlayer = new MediaPlayer(media);

                statusLabel.setText("Loaded: " + selectedFile.getName());
            } catch (Exception ex) {
                statusLabel.setText("Error: Unsupported media format");
            }
        } else {
            statusLabel.setText("No file selected");
        }
    }

    private void playMedia() {
        if (mediaPlayer == null) {
            statusLabel.setText("Error: No file loaded");
            return;
        }
        mediaPlayer.play();
        statusLabel.setText("Playing...");
    }

    private void pauseMedia() {
        if (mediaPlayer == null) {
            statusLabel.setText("Error: No file loaded");
            return;
        }
        mediaPlayer.pause();
        statusLabel.setText("Paused");
    }

    private void stopMedia() {
        if (mediaPlayer == null) {
            statusLabel.setText("Error: No file loaded");
            return;
        }
        mediaPlayer.stop();
        mediaPlayer.seek(Duration.ZERO);
        statusLabel.setText("Stopped");
    }

    public static void main(String[] args) {
        launch(args);
    }
}
